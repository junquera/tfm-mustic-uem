from math import sqrt

xys = [
    (1.2, 4.5),
    (1.8, 5.9),
    (3.1, 7.0),
    (4.9, 7.8),
    (5.7, 7.2),
    (7.1, 6.8),
    (8.6, 4.5),
    (9.8, 2.7)
]

# finisterre
xys = [(1.0, 10.6), (2.0, 9.5), (3.0, 13.4), (4.0, 11.7), (5.0, 16.4), (6.0, 17.9), (7.0, 18.8), (8.0, 20.4), (9.0, 19.4), (10.0, 16.5), (11.0, 12.4), (12.0, 12.4), (1.0, 11.4), (2.0, 10.8), (3.0, 12.0), (4.0, 13.0), (5.0, 13.2), (6.0, 16.4), (7.0, 20.4), (8.0, 20.3), (9.0, 19.7), (10.0, 17.7), (11.0, 13.3), (12.0, 11.4), (1.0, 11.4), (2.0, 10.9), (3.0, 12.4), (4.0, 14.9), (5.0, 15.1), (6.0, 18.3), (7.0, 19.3), (8.0, 19.9), (9.0, 20.8), (10.0, 18.8), (11.0, 13.5), (12.0, 11.3), (13.0, 15.6), (1.0, 10.7), (2.0, 10.0), (3.0, 11.7), (4.0, 14.8), (5.0, 15.9), (6.0, 17.9), (7.0, 20.0), (8.0, 19.2), (9.0, 17.6), (10.0, 16.4), (11.0, 15.5), (12.0, 14.1), (1.0, 12.1), (2.0, 11.0), (3.0, 11.1), (4.0, 12.1), (5.0, 15.2), (6.0, 17.6), (7.0, 19.8), (8.0, 20.1), (9.0, 18.7), (10.0, 16.7), (11.0, 13.0), (12.0, 13.1), (1.0, 10.4), (2.0, 11.8), (3.0, 12.9), (4.0, 14.3), (5.0, 17.4), (6.0, 18.7), (7.0, 19.9), (8.0, 19.8), (9.0, 18.3), (10.0, 17.8), (11.0, 13.0), (12.0, 11.2), (1.0, 11.6), (2.0, 9.4), (3.0, 10.6), (4.0, 13.2), (5.0, 14.8), (6.0, 17.4), (7.0, 19.7), (8.0, 20.3), (9.0, 19.6), (10.0, 16.0), (11.0, 13.2), (12.0, 13.2)]

# cabogata
xys = [
    (1.0, 12.2), (2.0, 10.8), (3.0, 14.5), (4.0, 15.6), (5.0, 20.4), (6.0, 24.1), (7.0, 25.8), (8.0, 26.7), (9.0, 23.7), (10.0, 19.3), (11.0, 16.4), (12.0, 13.5),
    (1.0, 13.3), (2.0, 12.5), (3.0, 14.8), (4.0, 16.5), (5.0, 18.3), (6.0, 22.2), (7.0, 26.6), (8.0, 28.0), (9.0, 25.3), (10.0, 22.0), (11.0, 15.7), (12.0, 14.0),
    (1.0, 14.0), (2.0, 13.8), (3.0, 15.7), (4.0, 18.6), (5.0, 20.5), (6.0, 23.5), (7.0, 25.8), (8.0, 26.9), (9.0, 25.1), (10.0, 22.5), (11.0, 17.7), (12.0, 14.0),
    (1.0, 13.1), (2.0, 13.5), (3.0, 14.5), (4.0, 17.9), (5.0, 21.4), (6.0, 24.7), (7.0, 28.7), (8.0, 28.3), (9.0, 23.7), (10.0, 21.1), (11.0, 17.3), (12.0, 15.2)
]
cabogata_2018 = [(1.0, 13.9), (2.0, 14.1), (3.0, 14.2), (4.0, 16.9), (5.0, 19.4), (6.0, 23.1), (7.0, 27.9), (8.0, 27.7), (9.0, 25.7), (10.0, 22.4), (11.0, 16.6), (12.0, 14.7), (1.0, 12.6), (2.0, 15.2), (3.0, 15.4), (4.0, 17.6), (5.0, 21.8), (6.0, 25.9), (7.0, 26.8), (8.0, 27.8), (9.0, 24.6), (10.0, 22.2), (11.0, 16.3), (12.0, 13.0), (1.0, 12.8), (2.0, 12.4), (3.0, 14.4), (4.0, 17.3), (5.0, 19.2), (6.0, 23.0), (7.0, 24.4), (8.0, 28.5), (9.0, 26.4), (10.0, 20.4), (11.0, 15.8), (12.0, 14.2)]

i = 0
j = 0
k = 0
l = 0

u = 0
v = 0
w = 0

n = len(xys)

for x, y in xys:
    i += x
    j += x**2
    k += x**3
    l += x**4

    u += y
    v += (x * y)
    w += ((x**2) * y)


print("i", i)
print("j", j)
print("k", k)
print("l", l)
print("u", u)
print("v", v)
print("w", w)

c = (u*l - w*j)/(l*n - j**2)
c += (j*k*l*v - j*(k**2)*w - i*(l**2)*v + i*k*l*w)/(j*(l**2)*n - (k**2)*l*n - (j**3)*l + (j**2)*(k**2))
r = ((j**2)*(k**2)-2*(i*j*k*l)+(i**2)*(l**2))/(j*(l**2)*n - (k**2)*l*n - (j**3)*l + (j**2)*(k**2))
c = c / (1 - r)

b = (v*l - k*w + c*j*k - c*i*l)/(j*l - k**2)
a = (w - b*k - c*j) / l

print("a", a)
print("b", b)
print("c", c)

print("%sxÂ² + %sx + %s" % (a, b, c))
